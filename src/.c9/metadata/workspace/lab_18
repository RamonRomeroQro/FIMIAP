{"changed":true,"filter":false,"title":"lab_18","tooltip":"/lab_18","value":"\nMateriales(Clave, Descripción, Costo, PorcentajeImpuesto) \nProveedores(RFC, RazonSocial) \nProyectos(Numero, Denominacion) \nEntregan(Clave, RFC, Numero, Fecha, Cantidad) \n\n\n Con base en lo que se explica en la lectura sobre funciones agregadas, plantea y ejecuta las siguientes consultas, agregando los alias de columna necesarios para que los resultados resulten legibles:\n\n<> La suma de las cantidades e importe total de todas las entregas realizadas durante el 97. \nset dateformat dmy\nSELECT SUM(Entregan.Cantidad) as 'Suma', SUM(Entregan.Cantidad*Materiales.Costo) as 'ImporteTotal'\nFROM Entregan, Materiales\nWHERE Entregan.Fecha BETWEEN '01/01/1997' AND '31/12/1997' AND Entregan.Clave = Materiales.Clave\n\n<> Para cada proveedor, obtener la razón social del proveedor, número de entregas e importe total de las entregas realizadas. \nSELECT Proveedores.RFC, Proveedores.RazonSocial, COUNT(Proveedores.RFC) as \"Numero de entregas\", SUM(Entregan.Cantidad*Materiales.Costo) as \"Importe Total\"\nFROM Proveedores,Entregan,Materiales\nWHERE Entregan.RFC = Proveedores.RFC AND Entregan.Clave = Materiales.Clave\nGROUP BY Proveedores.RFC, Proveedores.RazonSocial\n\n<> Por cada material obtener la clave y descripción del material, la cantidad total entregada, la mínima cantidad entregada, la máxima cantidad entregada, el importe total de las entregas de aquellos materiales en los que la cantidad promedio entregada sea mayor a 400. \nSELECT Materiales.Clave, Materiales.Descripcion, SUM(Entregan.Cantidad) as \"Cantidad Total Entregada\", MIN(Entregan.Cantidad)\nas \"Cantidad Mínima Entregada\", MAX(Entregan.Cantidad) as \"Cantidad Máxima Entregada\",  SUM(Entregan.Cantidad*Materiales.Costo)\nas \"Importe Total\"\nFROM Materiales, Entregan\nWHERE Entregan.Clave = Materiales.Clave\nGROUP BY Materiales.Clave, Materiales.Descripcion\nHAVING AVG(Entregan.Cantidad*Materiales.Costo) > 400\n\n\n<> Para cada proveedor, indicar su razón social y mostrar la cantidad promedio de cada material entregado, detallando la clave y descripción del material, excluyendo aquellos proveedores para los que la cantidad promedio sea menor a 500. \nSELECT Proveedores.RazonSocial, Materiales.Clave, Materiales.Descripcion, AVG(Entregan.Cantidad) as \"Cantidad Promedio de Entrega\"\nFROM Proveedores, Entregan, Materiales\nWHERE Proveedores.RFC = Entregan.RFC AND Entregan.Clave = Materiales.Clave AND Proveedores.RFC NOT IN (\n          SELECT Proveedores.RazonSocial\n          FROM Proveedores, Entregan\n          WHERE Proveedores.RFC = Entregan.RFC\n          GROUP BY Proveedores.RazonSocial\n          HAVING AVG(Entregan.Cantidad) > 500\n                                                              )\nGROUP BY Materiales.Clave, Materiales.Descripcion, Proveedores.RazonSocial\n\n\n<> Mostrar en una solo consulta los mismos datos que en la consulta anterior pero para dos grupos de proveedores: aquellos para los que la cantidad promedio entregada es menor a 370 y aquellos para los que la cantidad promedio entregada sea mayor a 450.\nSELECT Proveedores.RazonSocial, Materiales.Clave, Materiales.Descripcion, AVG(Entregan.Cantidad) as \"Cantidad Promedio de Entrega\"\nFROM Proveedores, Entregan, Materiales\nWHERE Proveedores.RFC = Entregan.RFC AND Entregan.Clave = Materiales.Clave AND Proveedores.RazonSocial NOT IN\n                                                                               (\n                                                                                SELECT Proveedores.RazonSocial\nFROM Proveedores, Entregan\nWHERE Proveedores.RFC = Entregan.RFC\nGROUP BY Proveedores.RazonSocial\nHAVING AVG(Entregan.Cantidad) BETWEEN 370 AND 450\n                                                                               )\nGROUP BY Materiales.Clave, Materiales.Descripcion, Proveedores.RazonSocial\n\n\nUtilizando la sentencia:\nINSERT INTO tabla VALUES (valorcolumna1, valorcolumna2, [...] , valorcolumnan) ;\nCon base en lo que se explica en la lectura sobre consultas con roles y subconsultas, plantea y ejecuta las siguientes consultas:\n\nConsiderando que los valores de tipos CHAR y VARCHAR deben ir encerrados entre apóstrofes, los valores numéricos se escriben directamente y los de fecha, como '1-JAN-00' para 1o. de enero del 2000, inserta cinco nuevos materiales.\n\nINSERT INTO Materiales VALUES (1500, Gravilla, 300, 25) ; \nINSERT INTO Materiales VALUES (1510, Grava, 250, 20) ; \nINSERT INTO Materiales VALUES (1520, Arena, 150, 15) ; \nINSERT INTO Materiales VALUES (1530, Yeso, 100, 10) ; \nINSERT INTO Materiales VALUES (1540, Cemento, 175, 15) ; \n\n\n\n\n<> Clave y descripción de los materiales que nunca han sido entregados.\n    SELECT M.Descripción, M.Clave\n    FROM Materiales M\n    WHERE M.Clave NOT IN (\n                          SELECT E.Clave \n                          FROM Entregan E\n                        )\n\n\n\n<> Razón social de los proveedores que han realizado entregas tanto al proyecto 'Vamos México' \n   como al proyecto 'Querétaro Limpio'. \n    SELECT p.RazonSocial \n    FROM Proveedores p, Entrega e, Proyectos py\n    WHERE p.RFC IN (\n                SELECT E.RFC\n                FROM Entregan E, Proyectos P\n                WHERE E.Numero = P.Numero AND P.Denominacion = 'Vamos México'\n                ) \n          AND p.RFC IN (\n                        SELECT E.RFC\n                        FROM Entregan E, Proyectos P\n                        WHERE E.Numero = P.Numero  AND P.Denominacion = 'Querétaro Limipio'\n                        )\n\n    \n<> Descripción de los materiales que nunca han sido entregados al proyecto 'CIT Yucatán'. \n\n    SELECT M.Descripción \n    FROM Materiales M\n    WHERE M.Clave NOT IN (\n                          SELECT E.Clave \n                          FROM Entregan E, Proyectos P\n                          WHERE E.Numero = P.Numero AND P.Denominacion = 'CIT Yucatán'\n                          )\n\n\n\n<> Razón social y promedio de cantidad entregada de los proveedores cuyo promedio de cantidad entregada es mayor al promedio de la cantidad entregada por el proveedor con el RFC 'VAGO780901'. \n\nSELECT P.RazonSocial, AVG(E.cantidad) AS 'Promedio Cantidad'\nFROM Proveedores AS P, Entregan AS E, Materiales AS M\nWHERE P.RFC = E.RFC AND E.clave = M.clave\nGROUP BY P.RazonSocial\nHAVING AVG(E.cantidad) > \n\t\t(\n\t\tSELECT AVG(E.cantidad)\n\t\tFROM Proveedores AS P, Entregan AS E, Materiales AS M\n\t\tWHERE P.RFC = 'VAGO780901' AND P.RFC = E.RFC AND E.clave = M.clave\n\t\t)\n\n\n<> RFC, razón social de los proveedores que participaron en el proyecto 'Infonavit Durango' y cuyas cantidades totales entregadas en el 2000 fueron mayores a las cantidades totales entregadas en el 2001.\n\nSET DATEFORMAT DMY\n\nSELECT P.RFC, P.RazonSocial \nFROM Proveedores AS P, Entregan AS E, Proyectos AS PROY\nWHERE PROY.Denominacion = 'Infonavit Durango' \nAND P.RFC = E.RFC AND PROY.Numero = E.Numero\nGROUP BY P.RFC, P.RazonSocial\nHAVING \n    (\n    SELECT SUM(E.cantidad) AS 'Cantidad Total 2000'\n    FROM Entregan AS E, Materiales AS M\n    WHERE E.clave = M.clave AND E.fecha BETWEEN '01/01/2000' AND '31/12/2000'\n    ) >\n        (\n        SELECT SUM(E.cantidad) AS 'Cantidad Total 2001'\n        FROM Entregan AS E, Materiales AS M\n        WHERE E.clave = M.clave AND E.fecha BETWEEN '01/01/2001' AND '31/12/2001'\n        )\n","undoManager":{"mark":-179,"position":100,"stack":[[{"start":{"row":68,"column":32},"end":{"row":68,"column":33},"action":"remove","lines":["l"],"id":1096}],[{"start":{"row":68,"column":31},"end":{"row":68,"column":32},"action":"remove","lines":["C"],"id":1097}],[{"start":{"row":68,"column":31},"end":{"row":68,"column":35},"action":"insert","lines":["1500"],"id":1098}],[{"start":{"row":68,"column":34},"end":{"row":68,"column":35},"action":"remove","lines":["0"],"id":1099}],[{"start":{"row":68,"column":33},"end":{"row":68,"column":34},"action":"remove","lines":["0"],"id":1100}],[{"start":{"row":68,"column":33},"end":{"row":68,"column":34},"action":"insert","lines":["4"],"id":1101}],[{"start":{"row":68,"column":34},"end":{"row":68,"column":35},"action":"insert","lines":["0"],"id":1102}],[{"start":{"row":64,"column":50},"end":{"row":64,"column":55},"action":"remove","lines":["Costo"],"id":1103},{"start":{"row":64,"column":50},"end":{"row":64,"column":51},"action":"insert","lines":["3"]}],[{"start":{"row":64,"column":50},"end":{"row":64,"column":51},"action":"remove","lines":["3"],"id":1104}],[{"start":{"row":64,"column":52},"end":{"row":64,"column":69},"action":"remove","lines":["PorcentajeImpuest"],"id":1105},{"start":{"row":64,"column":52},"end":{"row":64,"column":53},"action":"insert","lines":["2"]}],[{"start":{"row":64,"column":53},"end":{"row":64,"column":54},"action":"insert","lines":["3"],"id":1106}],[{"start":{"row":65,"column":57},"end":{"row":65,"column":74},"action":"remove","lines":["PorcentajeImpuest"],"id":1107},{"start":{"row":65,"column":57},"end":{"row":65,"column":58},"action":"insert","lines":["2"]}],[{"start":{"row":65,"column":58},"end":{"row":65,"column":59},"action":"insert","lines":["'"],"id":1108}],[{"start":{"row":65,"column":58},"end":{"row":65,"column":59},"action":"remove","lines":["'"],"id":1109}],[{"start":{"row":65,"column":58},"end":{"row":65,"column":59},"action":"insert","lines":["0"],"id":1110}],[{"start":{"row":64,"column":52},"end":{"row":64,"column":54},"action":"remove","lines":["23"],"id":1111},{"start":{"row":64,"column":52},"end":{"row":64,"column":53},"action":"insert","lines":["2"]}],[{"start":{"row":64,"column":53},"end":{"row":64,"column":54},"action":"insert","lines":["5"],"id":1112}],[{"start":{"row":66,"column":57},"end":{"row":66,"column":74},"action":"remove","lines":["PorcentajeImpuest"],"id":1113},{"start":{"row":66,"column":57},"end":{"row":66,"column":58},"action":"insert","lines":["1"]}],[{"start":{"row":66,"column":58},"end":{"row":66,"column":59},"action":"insert","lines":["5"],"id":1114}],[{"start":{"row":67,"column":57},"end":{"row":67,"column":74},"action":"remove","lines":["PorcentajeImpuest"],"id":1115},{"start":{"row":67,"column":57},"end":{"row":67,"column":58},"action":"insert","lines":["1"]}],[{"start":{"row":67,"column":58},"end":{"row":67,"column":59},"action":"insert","lines":["0"],"id":1116}],[{"start":{"row":68,"column":57},"end":{"row":68,"column":74},"action":"remove","lines":["PorcentajeImpuest"],"id":1117},{"start":{"row":68,"column":57},"end":{"row":68,"column":58},"action":"insert","lines":["1"]}],[{"start":{"row":68,"column":58},"end":{"row":68,"column":59},"action":"insert","lines":["7"],"id":1118}],[{"start":{"row":68,"column":58},"end":{"row":68,"column":59},"action":"remove","lines":["7"],"id":1119}],[{"start":{"row":68,"column":57},"end":{"row":68,"column":58},"action":"remove","lines":["1"],"id":1120}],[{"start":{"row":68,"column":57},"end":{"row":68,"column":58},"action":"insert","lines":["1"],"id":1121}],[{"start":{"row":68,"column":58},"end":{"row":68,"column":59},"action":"insert","lines":["5"],"id":1122}],[{"start":{"row":64,"column":37},"end":{"row":64,"column":48},"action":"remove","lines":["Descripción"],"id":1123},{"start":{"row":64,"column":37},"end":{"row":64,"column":38},"action":"insert","lines":["C"]}],[{"start":{"row":64,"column":38},"end":{"row":64,"column":39},"action":"insert","lines":["I"],"id":1124}],[{"start":{"row":64,"column":39},"end":{"row":64,"column":40},"action":"insert","lines":["N"],"id":1125}],[{"start":{"row":64,"column":39},"end":{"row":64,"column":40},"action":"remove","lines":["N"],"id":1126}],[{"start":{"row":64,"column":38},"end":{"row":64,"column":39},"action":"remove","lines":["I"],"id":1127}],[{"start":{"row":64,"column":37},"end":{"row":64,"column":38},"action":"remove","lines":["C"],"id":1128}],[{"start":{"row":64,"column":37},"end":{"row":64,"column":38},"action":"insert","lines":["C"],"id":1129}],[{"start":{"row":64,"column":38},"end":{"row":64,"column":39},"action":"insert","lines":["i"],"id":1130}],[{"start":{"row":64,"column":39},"end":{"row":64,"column":40},"action":"insert","lines":["n"],"id":1131}],[{"start":{"row":64,"column":40},"end":{"row":64,"column":41},"action":"insert","lines":["t"],"id":1132}],[{"start":{"row":64,"column":41},"end":{"row":64,"column":42},"action":"insert","lines":["a"],"id":1133}],[{"start":{"row":64,"column":42},"end":{"row":64,"column":43},"action":"insert","lines":[" "],"id":1134}],[{"start":{"row":64,"column":43},"end":{"row":64,"column":44},"action":"insert","lines":["R"],"id":1135}],[{"start":{"row":64,"column":43},"end":{"row":64,"column":44},"action":"remove","lines":["R"],"id":1136}],[{"start":{"row":64,"column":43},"end":{"row":64,"column":44},"action":"insert","lines":["N"],"id":1137}],[{"start":{"row":64,"column":44},"end":{"row":64,"column":45},"action":"insert","lines":["e"],"id":1138}],[{"start":{"row":64,"column":45},"end":{"row":64,"column":46},"action":"insert","lines":["g"],"id":1139}],[{"start":{"row":64,"column":46},"end":{"row":64,"column":47},"action":"insert","lines":["r"],"id":1140}],[{"start":{"row":64,"column":47},"end":{"row":64,"column":48},"action":"insert","lines":["a"],"id":1141}],[{"start":{"row":64,"column":50},"end":{"row":64,"column":51},"action":"insert","lines":["5"],"id":1142}],[{"start":{"row":64,"column":51},"end":{"row":64,"column":52},"action":"insert","lines":["0"],"id":1143}],[{"start":{"row":65,"column":37},"end":{"row":65,"column":48},"action":"remove","lines":["Descripción"],"id":1144},{"start":{"row":65,"column":37},"end":{"row":65,"column":38},"action":"insert","lines":["g"]}],[{"start":{"row":65,"column":37},"end":{"row":65,"column":38},"action":"remove","lines":["g"],"id":1145}],[{"start":{"row":65,"column":37},"end":{"row":65,"column":38},"action":"insert","lines":["G"],"id":1146}],[{"start":{"row":65,"column":38},"end":{"row":65,"column":39},"action":"insert","lines":["r"],"id":1147}],[{"start":{"row":65,"column":39},"end":{"row":65,"column":40},"action":"insert","lines":["a"],"id":1148}],[{"start":{"row":65,"column":40},"end":{"row":65,"column":41},"action":"insert","lines":["v"],"id":1149}],[{"start":{"row":65,"column":41},"end":{"row":65,"column":42},"action":"insert","lines":["a"],"id":1150}],[{"start":{"row":66,"column":37},"end":{"row":66,"column":48},"action":"remove","lines":["Descripción"],"id":1151},{"start":{"row":66,"column":37},"end":{"row":66,"column":38},"action":"insert","lines":["A"]}],[{"start":{"row":66,"column":38},"end":{"row":66,"column":39},"action":"insert","lines":["r"],"id":1152}],[{"start":{"row":66,"column":39},"end":{"row":66,"column":40},"action":"insert","lines":["e"],"id":1153}],[{"start":{"row":66,"column":40},"end":{"row":66,"column":41},"action":"insert","lines":["n"],"id":1154}],[{"start":{"row":66,"column":41},"end":{"row":66,"column":42},"action":"insert","lines":["a"],"id":1155}],[{"start":{"row":67,"column":37},"end":{"row":67,"column":48},"action":"remove","lines":["Descripción"],"id":1156},{"start":{"row":67,"column":37},"end":{"row":67,"column":38},"action":"insert","lines":["Y"]}],[{"start":{"row":67,"column":38},"end":{"row":67,"column":39},"action":"insert","lines":["e"],"id":1157}],[{"start":{"row":67,"column":39},"end":{"row":67,"column":40},"action":"insert","lines":["s"],"id":1158}],[{"start":{"row":67,"column":40},"end":{"row":67,"column":41},"action":"insert","lines":["o"],"id":1159}],[{"start":{"row":68,"column":37},"end":{"row":68,"column":48},"action":"remove","lines":["Descripción"],"id":1160},{"start":{"row":68,"column":37},"end":{"row":68,"column":38},"action":"insert","lines":["C"]}],[{"start":{"row":68,"column":38},"end":{"row":68,"column":39},"action":"insert","lines":["e"],"id":1161}],[{"start":{"row":68,"column":39},"end":{"row":68,"column":40},"action":"insert","lines":["m"],"id":1162}],[{"start":{"row":68,"column":40},"end":{"row":68,"column":41},"action":"insert","lines":["e"],"id":1163}],[{"start":{"row":68,"column":41},"end":{"row":68,"column":42},"action":"insert","lines":["n"],"id":1164}],[{"start":{"row":68,"column":42},"end":{"row":68,"column":43},"action":"insert","lines":["t"],"id":1165}],[{"start":{"row":68,"column":43},"end":{"row":68,"column":44},"action":"insert","lines":["o"],"id":1166}],[{"start":{"row":64,"column":43},"end":{"row":64,"column":48},"action":"remove","lines":["Negra"],"id":1167}],[{"start":{"row":64,"column":42},"end":{"row":64,"column":43},"action":"remove","lines":[" "],"id":1168}],[{"start":{"row":64,"column":41},"end":{"row":64,"column":42},"action":"remove","lines":["a"],"id":1169}],[{"start":{"row":64,"column":40},"end":{"row":64,"column":41},"action":"remove","lines":["t"],"id":1170}],[{"start":{"row":64,"column":39},"end":{"row":64,"column":40},"action":"remove","lines":["n"],"id":1171}],[{"start":{"row":64,"column":38},"end":{"row":64,"column":39},"action":"remove","lines":["i"],"id":1172}],[{"start":{"row":64,"column":37},"end":{"row":64,"column":38},"action":"remove","lines":["C"],"id":1173}],[{"start":{"row":64,"column":37},"end":{"row":64,"column":38},"action":"insert","lines":["G"],"id":1174}],[{"start":{"row":64,"column":38},"end":{"row":64,"column":39},"action":"insert","lines":["r"],"id":1175}],[{"start":{"row":64,"column":39},"end":{"row":64,"column":40},"action":"insert","lines":["a"],"id":1176}],[{"start":{"row":64,"column":40},"end":{"row":64,"column":41},"action":"insert","lines":["v"],"id":1177}],[{"start":{"row":64,"column":41},"end":{"row":64,"column":42},"action":"insert","lines":["i"],"id":1178}],[{"start":{"row":64,"column":42},"end":{"row":64,"column":43},"action":"insert","lines":["l"],"id":1179}],[{"start":{"row":64,"column":43},"end":{"row":64,"column":44},"action":"insert","lines":["l"],"id":1180}],[{"start":{"row":64,"column":44},"end":{"row":64,"column":45},"action":"insert","lines":["a"],"id":1181}],[{"start":{"row":64,"column":47},"end":{"row":64,"column":49},"action":"remove","lines":["50"],"id":1182},{"start":{"row":64,"column":47},"end":{"row":64,"column":48},"action":"insert","lines":["3"]}],[{"start":{"row":64,"column":48},"end":{"row":64,"column":49},"action":"insert","lines":["0"],"id":1183}],[{"start":{"row":64,"column":49},"end":{"row":64,"column":50},"action":"insert","lines":["0"],"id":1184}],[{"start":{"row":65,"column":44},"end":{"row":65,"column":49},"action":"remove","lines":["Costo"],"id":1185},{"start":{"row":65,"column":44},"end":{"row":65,"column":45},"action":"insert","lines":["2"]}],[{"start":{"row":65,"column":45},"end":{"row":65,"column":46},"action":"insert","lines":["5"],"id":1186}],[{"start":{"row":65,"column":46},"end":{"row":65,"column":47},"action":"insert","lines":["0"],"id":1187}],[{"start":{"row":66,"column":44},"end":{"row":66,"column":49},"action":"remove","lines":["Costo"],"id":1188},{"start":{"row":66,"column":44},"end":{"row":66,"column":45},"action":"insert","lines":["1"]}],[{"start":{"row":66,"column":45},"end":{"row":66,"column":46},"action":"insert","lines":["5"],"id":1189}],[{"start":{"row":66,"column":46},"end":{"row":66,"column":47},"action":"insert","lines":["0"],"id":1190}],[{"start":{"row":67,"column":43},"end":{"row":67,"column":48},"action":"remove","lines":["Costo"],"id":1191},{"start":{"row":67,"column":43},"end":{"row":67,"column":44},"action":"insert","lines":["1"]}],[{"start":{"row":67,"column":44},"end":{"row":67,"column":45},"action":"insert","lines":["0"],"id":1192}],[{"start":{"row":67,"column":45},"end":{"row":67,"column":46},"action":"insert","lines":["0"],"id":1193}],[{"start":{"row":68,"column":46},"end":{"row":68,"column":51},"action":"remove","lines":["Costo"],"id":1194},{"start":{"row":68,"column":46},"end":{"row":68,"column":47},"action":"insert","lines":["1"]}],[{"start":{"row":68,"column":47},"end":{"row":68,"column":48},"action":"insert","lines":["7"],"id":1195}],[{"start":{"row":68,"column":48},"end":{"row":68,"column":49},"action":"insert","lines":["5"],"id":1196}]]},"ace":{"folds":[],"scrolltop":887.4088611602783,"scrollleft":0,"selection":{"start":{"row":73,"column":62},"end":{"row":73,"column":62},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":54,"state":"start","mode":"ace/mode/text"}},"timestamp":1489473473686}