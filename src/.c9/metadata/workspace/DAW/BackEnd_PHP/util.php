{"changed":false,"filter":false,"title":"util.php","tooltip":"/DAW/BackEnd_PHP/util.php","value":"<?php\n\n/*\n    UTIL PHP ORGANIZACIÃ“N:\n        \n        BASE DE DATOS\n        GASTOS\n        DONCACIONES\n        TALLER\n        USUARIOS \n        NOTICIAS\n        ALUMNOS\n        INFORMACIÃ“N INST.\n        VALIDACION\n        \n*/\n\n \n\n/*\n _________________________________________ BASE DE DATOS _________________________________________ \n*/\n\n\n    function connectDB(){\n        $servidor=\"localhost\";\n        $username=\"ramonromerotec\";\n        $password=\"\";\n        $nombreBD=\"FIMQRO\";\n        \n        $conexion=mysqli_connect($servidor,$username,$password, $nombreBD);\n        if (!$conexion){\n            die (\"ConexiÃ³n fallida: \" . mysqli_connect_error());\n        }\n        \n        return $conexion;\n    }\n    \n    \n    function closeDB($conectar){\n        mysqli_close($conectar);\n    }\n\n\n/*\n _________________________________________ GASTOS _________________________________________ \n*/\n\n    function registrarGastos($descripcion, $monto , $fecha) {\n        $mysql = connectDB();\n        $query = 'INSERT INTO Gastos (descripcion,monto,fecha) VALUES (?,?,?)';\n        if (!($statement = $mysql->prepare($query))) {\n            //return false;\n            die(\"Preparation failed: (\" . $mysql->errno . \") \" . $mysql->error);\n        }\n        $user = $_SESSION[\"usuario\"];\n\t\tif (!$statement->bind_param(\"sds\",$descripcion, $monto , $fecha)) {\n            die(\"Parameter vinculation failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }\n\t\tif (!$statement->execute()) {\n            die(\"Execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        } \n         else {\n            closeDB($mysql);\n            return true;\n        }\n\n    }\n    \n    \n       \n     function consultarGastoPorFecha($FI,$FF){\n         $conecta=connectDB();\n         $sql = 'SELECT ID_Gastos, descripcion, monto, fecha\n                FROM Gastos\n                WHERE fecha\n                BETWEEN \"' . $FI . '\" AND \"' . $FF . '\" ORDER BY fecha DESC'; \n         $consulta= mysqli_query($conecta,$sql);\n         echo \"\";\n         closeDB($conecta);\n         return $consulta;\n     }\n     \n     \n       function consultarTot($FI,$FF){\n         $conecta=connectDB();\n         $sql = 'SELECT sum(monto) FROM Gastos\n         WHERE fecha\n         BETWEEN \"' . $FI . '\" AND \"' . $FF . '\" ORDER BY fecha DESC'; \n         $consulta= mysqli_query($conecta,$sql);\n         closeDB($conecta);\n         return $consulta;\n     }\n     \n     function consultarTotal(){\n         $conecta=connectDB();\n         $sql = 'SELECT sum(monto) FROM Gastos\n                ORDER BY fecha DESC'; \n         $consulta= mysqli_query($conecta,$sql);\n         closeDB($conecta);\n         return $consulta;\n     }\n     \n     function ultimosGastos(){\n         $conecta=connectDB();\n         $sql = 'SELECT * FROM Gastos ORDER BY fecha DESC LIMIT 10  '; \n         $consulta= mysqli_query($conecta,$sql);\n         closeDB($conecta);\n         return $consulta;\n     }\n    \n    function ultimosGastosTotales(){\n        $conecta=connectDB();\n         $sql = 'SELECT * FROM Gastos ORDER BY fecha DESC'; \n         $consulta= mysqli_query($conecta,$sql);\n         closeDB($conecta);\n         return $consulta;\n    }\n    \n/*\n _________________________________________ DONACIONES _________________________________________ \n*/\n\n\n\n/*\n _________________________________________ TALLER _________________________________________ \n*/\n\n   \n    function registrarTaller(\n        $nombre_taller,\n\t\t$fecha_taller,\n\t\t$costo_taller,\n\t\t$descripcion_taller\n        ) {\n        $mysql = connectDB();\n        $query = 'INSERT INTO Taller (\n            nombre_taller, \n            horarios,\n            costo,\n            descripcion\n            ) VALUES (?,?,?,?)';\n        if (!($statement = $mysql->prepare($query))) {\n            //return false;\n            die(\"Preparation failed: (\" . $mysql->errno . \") \" . $mysql->error);\n        }\n        $user = $_SESSION[\"usuario\"];\n\t\tif (!$statement->bind_param(\"ssds\",\n\t\t$nombre_taller,\n\t\t$fecha_taller,\n\t\t$costo_taller,\n\t\t$descripcion_taller\n\t\n        )) {\n            die(\"Parameter vinculation failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }\n\t\tif (!$statement->execute()) {\n            die(\"Execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        } \n         else {\n            closeDB($mysql);\n            return true;\n        }\n\n    }\n    \n    function listaTalleres() {\n        $mysql = connectDB();\n        $query = \"SELECT * FROM Taller ORDER By nombre_taller ASC\";\n        $result = $mysql -> query($query);\n        $tabla = '';\n            while($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {\n                $tabla.='<tr>';\n                $tabla.='<td onclick=\"mostrarInscritas('.$row[\"ID_Taller\"].')\">'.$row[\"nombre_taller\"].'</td>';\n                $tabla.='<td onclick=\"mostrarInscritas('.$row[\"ID_Taller\"].')\">'.$row[\"horarios\"].'</td>';\n                $tabla.='<td onclick=\"mostrarInscritas('.$row[\"ID_Taller\"].')\">'.$row[\"costo\"].'</td>';\n                $tabla.='<td onclick=\"mostrarInscritas('.$row[\"ID_Taller\"].')\">'.$row[\"descripcion\"].'</td>';\n                $tabla.='<td> <a href=\"modificarTaller.php?id='.$row[\"ID_Taller\"].'\"> <i class=\"material-icons\">mode_edit</i> </a> </td>';\n                $tabla.='<td onclick=\"confirmarEliminacionTaller('. $row[\"ID_Taller\"]. ')\"> <a href=\"#\"> <i class=\"material-icons\">delete</i> </a></td>';\n                $tabla.='</tr>';\n            }\n        closeDB($mysql);\n\t\treturn $tabla;\n    }\n    \n    \n    function eliminarTaller($id) {\n        $mysql = connectDB();\n        $query = 'DELETE From Taller WHERE ID_Taller ='.$id;\n        mysqli_query($mysql, $query);\n        closeDB($mysql);\n    }\n    \n    \n     function listaTalleresShow() {\n        $mysql = connectDB();\n        $query = \"SELECT * FROM Taller\";\n        $result = $mysql -> query($query);\n        $tabla = '<table class=\"striped highlight centered  \">';\n         $tabla.='<thead><tr>';\n                $tabla.='<th>Actividad</th>';\n                $tabla.='<th>Horarios</th>';\n                $tabla.='<th>Costo</th>';\n                $tabla.='<th>DescripciÃ³n</th>';\n            $tabla.='</tr></thead>';\n\n                    \n            while($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {\n                $tabla.='<tr>';\n                $tabla.='<td>' . $row[\"nombre_taller\"].'</td>';\n                $tabla.='<td>' . $row[\"horarios\"].'</td>';\n                $tabla.='<td>' . $row[\"costo\"].'</td>';\n                $tabla.='<td>' . $row[\"descripcion\"].'</td>';\n                    $tabla.='</tr>';\n            }\n        $tabla .= '</table>';\n        closeDB($mysql);\n\t\treturn $tabla;\n    }\n    \n   \n   function consultarTaller(){\n         $conecta=connectDB();\n         $sql = 'SELECT * FROM Taller '; \n         $consulta= mysqli_query($conecta,$sql);\n         closeDB($conecta);\n         return $consulta;\n       \n   }\n   \n   function recuperarInformacionTaller($id){\n            $conectar = connectDB();\n            $query = 'SELECT * FROM Taller WHERE ID_Taller='.$id;\n            $result = $conectar -> query($query);\n            if(!$result){\n                return \"\";\n            }\n            $row = mysqli_fetch_array($result, MYSQLI_BOTH);\n            closeDB($conectar);\n            return $row;\n    }\n\n    function modificarInfoTaller($id, $nombre, $costo, $horario, $descripcion){\n          $mysql = connectDB();\n         \n            $query = 'UPDATE Taller\n                SET nombre_taller ='.\"'\".$nombre.\"'\".', \n                horarios ='.\"'\".$costo.\"'\".',\n                costo ='.\"'\".$horario.\"'\".',\n                descripcion ='.\"'\".$descripcion.\"'\".'\n                WHERE ID_Taller ='.$id;\n            //var_dump($query);\n       \n            if (!($statement = $mysql->prepare($query)) ) {\n                //return false;\n                die(\"Preparation in table Update Taller failed: (\" . $mysql->errno . \") \" . $mysql->error);\n            }\n            \n    \t\tif (!$statement->execute()) {\n                die(\"Update execution failed: (\" . $statement->errno . \") \" . $statement->error);\n                closeDB($mysql);\n                return false;\n            }else{\n            closeDB($mysql);\n            return true;\n            }\n    }\n    \n    //regresa Talleres en los que estÃ¡ inscrita la alumna con id $id\n    function listaTalleresDeAlumna($id){\n        $mysql = connectDB();\n        $query = 'SELECT t.ID_Taller, t.nombre_taller FROM Taller t, Inscriben i WHERE i.ID_Alumno='.$id.' AND i.ID_Taller = t.ID_Taller ORDER BY nombre_taller ASC';\n        $result = $mysql -> query($query);\n        $lista = \"\";\n        while ($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {\n            $lista.='<li class=\"collection-item\" onclick=\"mostrarInfoTaller('.$row[\"ID_Taller\"].')\">'.$row[\"nombre_taller\"].'</li>';\n        }\n        closeDB($mysql);\n        return $lista;\n    }\n    \n    //regresa Talleres que estÃ¡n disponibles para la alumna con id $id\n    function listaTalleresDisponibles($id,$input) {\n        $mysql = connectDB();\n        $query = 'SELECT nombre_taller, ID_Taller FROM Taller WHERE ID_Taller NOT IN \n        (SELECT t.ID_Taller FROM Taller t, Inscriben i WHERE i.ID_Alumno='.$id.' \n        AND i.ID_Taller = t.ID_Taller) ORDER By nombre_taller ASC';\n        $result = $mysql -> query($query);\n        $lista = \"\";\n        while ($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {\n            if ($input === \"\"){\n                $lista.='<li class=\"collection-item\" onclick=\"seleccionarTaller('.$row[\"ID_Taller\"].')\">'.$row[\"nombre_taller\"].'</li>';\n            } elseif (!(strpos(strtolower($row[\"nombre_taller\"]), strtolower($input)) === FALSE)){\n                $lista.='<li class=\"collection-item\" onclick=\"seleccionarTaller('.$row[\"ID_Taller\"].')\">'.$row[\"nombre_taller\"].'</li>';\n            }\n        }\n        closeDB($mysql);\n        return $lista;\n    }\n    \n    //regresa la informaciÃ³n del Taller con id $id\n    function infoTaller($id,$inscripcion) {\n        $mysql = connectDB();\n        $query = 'SELECT * FROM Taller WHERE ID_Taller='.$id;\n        $result = $mysql -> query($query);\n        $row = mysqli_fetch_array($result, MYSQLI_BOTH);\n        $info = '<h5>'.$row[\"nombre_taller\"].'</h5> <hr>';\n        $info.= '<p>'. $row[\"descripcion\"].'</p>';\n        $info.='<p> Horarios: '.$row[\"horarios\"].\"</p>\";\n        $info.='<p> Costo: '.$row[\"costo\"].'</p>';\n        \n        if ($inscripcion === TRUE) { // habilita botÃ³n para inscribir\n            $info.= '<div class=\"row col s12\">\n                        <h5> Monto: </h5> \n                        <div id=\"msgError\" hidden> Debes introducir una cantidad </div>\n                    </div>\n                    <div class=\"row col s12\"> \n                        <input class=\"col s5\" id=\"monto\" type=\"number\" placeholder=0.00>\n                        <div class=\"col s3\"> </div>\n                        <button class=\"btn blueFim col s3\" onclick=\"inscribirTaller('.$id.')\"> Inscribir </button>\n                    </div>';\n        } else { //hablita botÃ³n para eliminar inscripciÃ³n\n            $info.= '<button class=\"btn red col s3\" onclick=\"eliminarInscripcionTaller('.$id.')\"> Eliminar inscripciÃ³n </button>';\n        }\n        closeDB($mysql);\n        return $info;\n    }\n    \n    function inscripcionTaller($idTaller, $idAlumna, $monto) {\n        $mysql = connectDB();\n        if ($monto === FALSE) {\n            $query = 'DELETE FROM Inscriben WHERE ID_Taller='.$idTaller.' AND ID_Alumno='.$idAlumna;\n        } else {\n            $fecha = date('Y-m-d');\n            $query =  'INSERT INTO Inscriben(monto,fecha,ID_Alumno,ID_Taller)\n            VALUES('.$monto.',\"'.$fecha.'\",'.$idAlumna.','.$idTaller.')';\n        }\n        $mysql -> query($query);\n        closeDB();\n    }\n    \n    //regresa Alumnas inscritas en Taller con id $id\n    function alumnasInscritas($id){\n        $mysql = connectDB();\n        $query = 'SELECT a.Nombre, a.Apellidos, a.Estatus, i.fecha\n                    FROM Inscriben i, Alumnos a\n                    WHERE i.ID_Taller='.$id.' AND i.ID_Alumno = a.ID_Alumno\n                    ORDER BY a.nombre ASC';\n        $results = $mysql -> query($query);\n        $tabla.='<thead>\n                    <tr>\n                    <th class=\"minWidth\">Nombre(s)</th>\n                    <th class=\"minWidth\">Apellido(s)</th>\n                    <th class=\"minWidth\">Status</th>\n                    <th class=\"minWidth\">Fecha de inscripciÃ³n</th>\n                    </tr>\n                    </thead>\n                    <tbody>';\n     \n        while($row = mysqli_fetch_array($results, MYSQLI_BOTH)) {\n            $tabla.='<tr>';\n            $tabla.='<td>' .$row[\"Nombre\"].'</td>';\n            $tabla.='<td>' .$row[\"Apellidos\"].'</td>';\n            $tabla.='<td>' .$row[\"Estatus\"].'</td>';\n            $tabla.='<td>' .$row[\"fecha\"].'</td>';\n            $tabla.='</tr>';\n        }\n            \n        $tabla.= \"</tbody>\";\n        closeDB($mysql);\n        return $tabla;\n\n    }\n    \n    /*Consulta alumnas inscritas por fecha*/\n    function alumnasInscritasFecha($id, $fechaInicial, $fechaFinal){\n        $mysql = connectDB();\n        $query = 'SELECT a.Nombre, a.Apellidos, a.Estatus, i.fecha\n                    FROM Inscriben i, Alumnos a\n                    WHERE i.ID_Taller='.$id.' AND i.ID_Alumno = a.ID_Alumno\n                    AND i.fecha BETWEEN \"'.$fechaInicial.'\" AND \"'.$fechaFinal.'\" \n                    ORDER BY fecha DESC, a.nombre ASC';\n        $results = $mysql -> query($query);\n        $tabla.='<thead>\n                    <tr>\n                    <th class=\"minWidth\">Nombre(s)</th>\n                    <th class=\"minWidth\">Apellido(s)</th>\n                    <th class=\"minWidth\">Status</th>\n                    <th class=\"minWidth\">Fecha de inscripciÃ³n</th>\n                    </tr>\n                    </thead>\n                    <tbody>';\n     \n        while($row = mysqli_fetch_array($results, MYSQLI_BOTH)) {\n            $tabla.='<tr>';\n            $tabla.='<td>' .$row[\"Nombre\"].'</td>';\n            $tabla.='<td>' .$row[\"Apellidos\"].'</td>';\n            $tabla.='<td>' .$row[\"Estatus\"].'</td>';\n            $tabla.='<td>' .$row[\"fecha\"].'</td>';\n            $tabla.='</tr>';\n        }\n            \n        $tabla.= \"</tbody>\";\n        closeDB($mysql);\n        return $tabla;\n\n    }\n    \n/*\n _________________________________________ USUARIOS _________________________________________ \n*/\n    function obtenerUsuarios () {\n         $conecta=connectDB();\n         $sql = \"SELECT nombre_usuario, contrasena FROM Usuarios \"; //ESTO \n         $consulta= mysqli_query($conecta,$sql);\n         closeDB($conecta);\n         return $consulta;\n    }\n\n    \n    function registrarUsuario(\n                                $first_name, \n                                $last_name, \n                                $calle_numero,\n                                $colonia,\n                                $municipio_empleado,\n                                $codigo_p,\n                                $fecha_nac,\n                                $icon_telephone,\n                                $celular,\n                                $tipo_empleado,\n                                $email,\n                                $password) {\n        $mysql = connectDB();\n        $query = 'INSERT INTO Usuarios(\n            ID_ROL,\n            nombre_usuario, \n            contrasena,\n            nombre,\n            apellidos,\n            telefono_casa,\n            fecha_nacimiento,\n            telefono_celular,\n            calle_numero,\n            colonia,\n            zip_code,\n            municipio,\n            email) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)';\n        if (!($statement = $mysql->prepare($query))) {\n            //return false;\n            die(\"Preparation failed: (\" . $mysql->errno . \") \" . $mysql->error);\n        }\n        $user = $_SESSION[\"usuario\"];\n\t\tif (!$statement->bind_param(\"isssssssssiss\",\n\t\t$tipo_empleado,\n\t\t$email, \n\t\t$password,\n\t\t$first_name, //$tipo_empleado\n        $last_name, \n        $icon_telephone,\n        $fecha_nac,\n        $celular,\n        $calle_numero,\n        $colonia,\n        $codigo_p,\n        $municipio_empleado,\n        $email\n        )) {\n            die(\"Parameter vinculation failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }\n\t\tif (!$statement->execute()) {\n            die(\"Execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        } \n         else {\n            closeDB($mysql);\n            return true;\n        }\n    }\n    \n    function listaUsuarios() {\n        $mysql = connectDB();\n        $query = \"SELECT * FROM Usuarios ORDER BY apellidos DESC\";\n        $result = $mysql -> query($query);\n        $tabla = '';\n            while($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {\n                $tabla.='<tr>';\n                    $tabla.='<td onclick=\"mostrarUsuario('.$row[\"ID_Usuario\"].')\">' .$row[\"apellidos\"].'</td>';\n                    $tabla.='<td onclick=\"mostrarUsuario('.$row[\"ID_Usuario\"].')\">' .$row[\"nombre\"].'</td>';\n                    $tabla.= '<td onclick=\"mostrarUsuario('.$row[\"ID_Usuario\"].')\">' . $row[\"telefono_celular\"] . '</td>';\n                    $tabla.='<td> <a href=\"modificarUsuario.php?id='.$row[\"ID_Usuario\"].'\"><i class=\"material-icons\">mode_edit</i></a> </td>';\n                    $tabla.='<td onclick=\"confirmarEliminacionUsuario('. $row[\"ID_Usuario\"]. ')\"> <a href=\"#\"><i class=\"material-icons\">delete</i> </a></td>';\n                $tabla.='</tr>';\n            }\n        closeDB($mysql);\n\t\treturn $tabla;\n    }\n    \n    function eliminarUsuario($id) {\n        $mysql = connectDB();\n        $query = 'DELETE From Usuarios WHERE ID_Usuario ='.$id;\n        mysqli_query($mysql, $query);\n        closeDB($mysql);\n    }\n    \n    function recuperaUsuario($id) {\n        $mysql = connectDB();\n        $query = 'SELECT * FROM Usuarios WHERE ID_Usuario=' . $id;\n        $result = $mysql -> query($query);\n        $row = mysqli_fetch_array($result, MYSQLI_BOTH);\n        closeDB($mysql);\n        return $row;\n    }\n    \n    function modificarUsuario($id, $first_name, $last_name, $calle_numero, $colonia,\n                    $municipio, $codigo_p, $fecha_nac,\n                    $icon_telephone, $celular, $tipo_empleado, $email,\n                    $password){ //nombre_usuario == email\n        $mysql = connectDB();\n        $query = 'UPDATE Usuarios SET ID_ROL=?, nombre_usuario=?, contrasena=?, nombre=?, apellidos=?, telefono_casa=?, \n                fecha_nacimiento=?, telefono_celular=?, calle_numero=?, colonia=?, zip_code=?, municipio=?,\n                email=? WHERE ID_Usuario=?;';\n                 \n                \n        if(!($statement = $mysql->prepare($query))) {\n            die(\"Preparation failed: (\" . $mysql-> errno .\")\".$mysql->error);\n            return false;\n        }\n        //Bind statement\n        if(!$statement->bind_param(\"isssssssssissi\", $tipo_empleado, $email, $password, $first_name, $last_name,\n                                    $icon_telephone, $fecha_nac, $celular, $calle_numero, $colonia, $codigo_p, $municipio,\n                                    $email, $id)){\n            die(\"Parameter vinculation failed: (\" .$statement->errno. \")\" .$statement->error);\n            return false;\n        }\n        if(!$statement->execute()) {\n            die(\"Execution failed: (\" .$statement->errno.\") \". $statement->error);\n            return false;\n        }\n        \n       closeDB($mysql);\n       return true;\n    }\n\n    function tablaInfoUsuarios($id){\n        $conectar = connectDB();\n                $query =\"SELECT *\n                        FROM Usuarios\n                        WHERE ID_Usuario = '$id'\";       \n                \n                $results = $conectar->query($query);\n                $row = mysqli_fetch_array($results, MYSQLI_ASSOC);\n                $tabla = '';\n               \n                    $tabla.='<tr>';\n                    $tabla.='<td>' .$row[\"nombre_usuario\"].'</td>';\n                    $tabla.='<td>' .$row[\"contrasena\"].'</td>';\n                    $tabla.='<td>' .$row[\"nombre\"].'</td>';\n                    $tabla.='<td>' .$row[\"apellidos\"].'</td>';\n                    $tabla.='<td>' .$row[\"telefono_casa\"].'</td>';\n                    $tabla.='<td>' .$row[\"telefono_celular\"].'</td>';\n                    $tabla.='<td>' .$row[\"fecha_nacimiento\"].'</td>';\n                    $tabla.='<td>' .$row[\"calle_numero\"].'</td>';\n                    $tabla.='<td>' .$row[\"colonia\"].'</td>';\n                    $tabla.='<td>' .$row[\"zip_code\"].'</td>';\n                    $tabla.='<td>' .$row[\"municipio\"].'</td>';\n                    $tabla.='<td>' .$row[\"email\"].'</td>';\n                    $tabla.='</tr>';\n            closeDB($conectar);\n            return $tabla;                \n    }\n\n/*\n  _________________________________________  NOTICIA _________________________________________\n*/\n    \n    function obtenerArrayNoticias() {\n        $mysql = connectDB();\n        $query = 'CALL listaNoticias()';\n        $result = $mysql -> query($query);\n        $listaNoticias = array();\n        $fecha = strtotime($row[fecha]);\n        while($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {\n            $fecha = strtotime($row[\"fecha\"]);\n            $fecha = date('d/m/Y', $fecha);\n            $elemento = '<a href=\"vernoticia.php?id='.$row[\"ID_Noticia\"].'\"><li>';\n            $imagen = recuperaImagenNoticia($row['ID_Noticia']);\n            if ($imagen) {\n                $elemento.= '<img src=\"'.$imagen['ubicacion'].'\"/>';\n            }\n            $elemento.= \"<h5><strong>\".$row[\"titulo\"].\"</strong></h5>\";\n            $elemento.=\"<p>\". $fecha . \"</p>\";\n            $elemento.=\"</li></a>\";\n            $listaNoticias[] = $elemento; \n        }\n        return $listaNoticias;\n    }\n    \n   function registrarNoticia($tit, $cont, $img, $descripcionimg,$fecha, $usuario) {\n        $mysql = connectDB();\n        $query = 'INSERT INTO Noticia (nombre_usuario,titulo,descripcion,fecha) VALUES (?,?,?,?)';\n        if (!($statement = $mysql->prepare($query))) {\n            //return false;\n            die(\"Preparation failed: (\" . $mysql->errno . \") \" . $mysql->error);\n        }\n\t\tif (!$statement->bind_param(\"ssss\", $usuario, $tit, $cont, $fecha)) {\n            die(\"Parameter vinculation failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }\n\t\tif (!$statement->execute()) {\n            die(\"Execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        } \n\n        if($img != NULL) {\n            $idnoticia = $mysql->insert_id;\n            if(registrarImagen($idnoticia, $img,$descripcionimg, $mysql)) {\n                closeDB($mysql);\n                return true;\n            } else {\n                return false;\n            }\n        } else {\n            return true;\n        }\n        \n    }\n    \n    function registrarImagen($idnot, $img, $descripcionimg, $mysql) {\n        $query = 'INSERT INTO Imagen (ubicacion,ID_Noticia,descripcion) VALUES (?,?,?)';\n        if (!($statement = $mysql->prepare($query))) {\n            return false;\n            die(\"Preparation failed: (\" . $mysql->errno . \") \" . $mysql->error);\n        }\n\t\tif (!$statement->bind_param(\"sis\", $img, $idnot, $descripcionimg)) {\n            die(\"Parameter vinculation failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }\n\t\tif (!$statement->execute()) {\n            die(\"Execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        } \n        return true;\n    }\n    \n    function listaNoticias() {\n        $mysql = connectDB();\n        $query = \"CALL listaNoticias()\";\n        $result = $mysql -> query($query);\n        $tabla = '';\n            while($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {\n                $tabla.='<tr>';\n                $tabla.='<td>' .$row[\"titulo\"].'</td>';\n                $fecha = $row[\"fecha\"];\n                $fecha = date_create($fecha);\n                $fecha = date_format($fecha, 'd/m/Y'); \n                $tabla.= '<td>' . $fecha . '</td>';\n                $tabla.='<td> <a href=\"modificarNoticia.php?id='.$row[\"ID_Noticia\"]. '&titulo=' . $row[\"titulo\"]. '\"> <i class=\"material-icons\">mode_edit</i> </a> </td>';\n                $tabla.='<td onclick=\"confirmarEliminacionNoticia('. $row[\"ID_Noticia\"]. ')\"> <a href=\"#\"> <i class=\"material-icons\">delete</i> </a></td>';\n                $tabla.='</tr>';\n            }\n        closeDB($mysql);\n\t\treturn $tabla;\n    }\n    \n    function modificaNoticia($id, $titulo, $contenido, $img, $descripcionimagen) {\n        $mysql = connectDB();\n        $query = 'UPDATE Noticia SET titulo=?, descripcion=?, nombre_usuario=? WHERE ID_Noticia=?;';\n         if (!($statement = $mysql->prepare($query))) {\n            die(\"Preparation failed: (\" . $mysql->errno . \") \" . $mysql->error);\n            return false;\n        }\n        $user = $_SESSION[\"usuario\"];\n        // Binding statement params \n        if (!$statement->bind_param(\"sssi\", $titulo, $contenido, $user, $id)) {\n            die(\"Parameter vinculation failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }\n        if (!$statement->execute()) {\n            die(\"Execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        } \n       \n        $imagenactual = recuperaImagenNoticia($id); //recuperar imagen asociada con la noticia (si es que la hay)\n        if ($img !== NULL) { //se introdujo alguna imagen en el formulario \n            if ($imagenactual) { //hay una imagen asociada con la noticia\n                if ($img != 0) {  //la imagen que se introdujo en el formulario es diferente a la que se recuperÃ³\n                    if (!(modificaImagen($id, $img, $descripcionimagen, $mysql))) { //modificar imagen\n                        return false;\n                    }\n                } else if ($descripcionimagen != $imagenactual[\"descripcion\"]){ //verificar si solo se cambio la descripciÃ³n de la imagen recuperada\n                    if (!(modificaImagen($id, $imagenactual[\"ubicacion\"], $descripcionimagen, $mysql))) { //modificar descripciÃ³n de la imagen\n                        return false;\n                    }\n                } \n            } else {\n                if (!(registrarImagen($id,$img,$descripcionimagen,$mysql))) { //no habÃ­a una imagen, y agregÃ³ una nueva\n                    return false;\n                }\n            } \n        } else if ($imagenactual){ //se eliminÃ³ la imagen de la noticia\n            removerRegistroImagen($id);\n        }\n        \n        closeDB($mysql);\n        return true;\n    }\n    \n    function modificaImagen($id, $ubicacion, $descripcion, $mysql) {\n        $query = 'UPDATE Imagen SET ubicacion=?, descripcion=? WHERE ID_Noticia='.$id;\n          if (!($statement = $mysql->prepare($query))) {\n            die(\"Preparation failed: (\" . $mysql->errno . \") \" . $mysql->error);\n            return false;\n        }\n        $user = $_SESSION[\"usuario\"];\n        // Binding statement params \n        if (!$statement->bind_param(\"ss\", $ubicacion, $descripcion)) {\n            die(\"Parameter vinculation failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }\n        \n        if (!$statement->execute()) {\n            die(\"Execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n\n        } \n        return true;\n    }\n    \n    function recuperaNoticia($id) {\n        $mysql = connectDB();\n        $query = 'SELECT * FROM Noticia WHERE ID_Noticia=' . $id;\n        $result = $mysql -> query($query);\n        $row = mysqli_fetch_array($result, MYSQLI_BOTH);\n        closeDB($mysql);\n        return $row;\n    }\n\n    function eliminarNoticia($id) {\n        $mysql = connectDB();\n        removerRegistroImagen($id);\n        $query = 'DELETE From Noticia WHERE ID_Noticia='.$id;\n        mysqli_query($mysql, $query);\n        closeDB($mysql);\n    }\n\n    function recuperaImagenNoticia($id) {\n        $mysql = connectDB();\n        $query = 'SELECT * FROM Imagen WHERE ID_Noticia='. $id;\n        $result = $mysql -> query($query);\n        if (($result->num_rows)>0) {\n            $row =  mysqli_fetch_array($result, MYSQLI_BOTH);\n            closeDB($mysql);\n            return $row;\n        }\n        else {\n            closeDB($mysql);\n            return false;\n        }\n    }\n    \n    function numeroPaginasNoticia() {\n        $numeronoticias = count(obtenerArrayNoticias());\n        $noticiasporpagina = 5;\n        $numeropaginas = ceil($numeronoticias/$noticiasporpagina);\n        $pagination = '<ul class=\"pagination\">\n            <li class=\"disabled\" id=\"anterior\" onclick=\"paginaAnterior()\"><a href=\"#!\"><i class=\"material-icons\">chevron_left</i></a></li>\n            <li class=\"\" id=\"1\" onclick=\"despliegaNoticias(1)\"><a href=\"#!\">1</a></li>';\n        $i = 2;\n        while ($i<=$numeropaginas) {\n            $pagination.= '<li class=\"\" id=\"'.$i.'\"onclick=\"despliegaNoticias('.$i.')\"><a href=\"#!\">'.$i.'</a></li>';\n            $i++;\n        }\n        $pagination.='<li class=\"disabled\" id=\"siguiente\" onclick=\"siguientePagina()\"><a href=\"#!\"><i class=\"material-icons\">chevron_right</i></a></li>\n            </ul>';\n        echo $pagination;\n    }\n    \n    function vistaNoticia($id) {\n        $noticia = recuperaNoticia($id);\n        $imagen = recuperaImagenNoticia($id);\n        $vistaNoticia = '<h1 id=\"tituloNoticia\">'.$noticia[\"titulo\"].' </h1> <hr>'; //tÃ­tulo de la noticia\n        $vistaNoticia.=  '<div id=\"infonoticia\"> FormaciÃ³n Integral de La Mujer &nbsp | &nbsp QuerÃ©taro, MÃ©xico. \n        &nbsp | &nbsp' .$noticia[\"fecha\"]. '</div><br>'; //informaciÃ³n de la noticia\n        \n        if ($imagen) {\n            $vistaNoticia.=' <img class=\"materialboxed\" width=\"100%\" src=\"'.$imagen['ubicacion'].'\"><br>'; //imagen\n            $vistaNoticia.='<div id=\"caption\">'.$imagen['descripcion']. '</div> '; //caption imagen\n        }\n        \n        $vistaNoticia.= '<div id=\"contenido\"> <h5>'.$noticia[\"descripcion\"].'</h5></div><hr>'; //contenido de Noticia\n        return $vistaNoticia;\n    }\n    \n    function removerRegistroImagen($id) {\n        $mysql = ConnectDB();\n        //Eliminar archivo del servidor\n        $query1 = 'SELECT * FROM Imagen WHERE ID_Noticia='.$id;\n        $row = mysqli_fetch_array($mysql->query($query1), MYSQLI_BOTH);\n        $archivo = __DIR__ .'/'. $row[\"ubicacion\"];\n        unlink($archivo);\n        \n        //Eliminar registro de imagen de la base de datos\n        $query2 = 'DELETE FROM Imagen WHERE ID_Noticia='.$id;\n        $mysql -> query($query2);\n        closeDB($mysql);\n    }\n \n/*\n _________________________________________ ALUMNOS _________________________________________ \n*/\n\n \n \n    /*registrar beneficiaria -> */\n    \n    //evitar registros duplicados\n        function noDuplicado($first_name, $last_name, $fecha_nac_alumna){\n            \n                $conectar = connectDB();\n                $query =\"SELECT COUNT(*) AS filas\n                        FROM Alumnos\n                        WHERE Nombre = '$first_name'\n                        AND Apellidos = '$last_name'\n                        AND Fecha_de_nacimiento = '$fecha_nac_alumna'\";       \n                \n                $results = $conectar->query($query);\n                //var_dump($query);\n                $row = mysqli_fetch_array($results, MYSQLI_ASSOC);\n                $numero = $row[\"filas\"];\n        \n                if ($numero == 0) {\n                    echo \"<script type='text/javascript'>console.log( 'REGISTRAR');</script>\";\n                    mysqli_free_result($results);\n                    closeDB($conectar);\n                    return true;\n                }else{\n                    echo \"<script type='text/javascript'>console.log('NO PUEDES REGISTRAR');</script>\";\n                    mysqli_free_result($results);\n                    closeDB($conectar);\n                    return false;\n                }\n                \n        }\n\n    //registrar alumna\n    function registrarAlumno(\n        $first_name, \n        $last_name, \n        $calle_numero,\n        $colonia,\n        $municipio,\n        $cp,\n        $ocupacion,\n        $estado_civil,\n        $fecha_nac_alumna,\n        $telefono_casa_alumna,\n        $celular,\n        $genero_alumna,\n        $estatus_fim,\n        $enteraste,\n        $nombre_emergencia,\n        $emergencia_tel\n        ){\n            \n        $mysql = connectDB();\n\n        $query = 'INSERT INTO Alumnos (\n            Nombre, \n            Apellidos, \n            Calle_numero, \n            Colonia, \n            ZIP, \n            Municipio, \n            Ocupacion, \n            Estado_Civil, \n            Fecha_de_nacimiento, \n            Genero, \n            Tcasa, \n            Tcel, \n            Estatus, \n            Contacto_Nombre, \n            Contacto_telefono, \n            medio_se_entero_FIM\n        ) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)';\n\n            \n        if (!($statement = $mysql->prepare($query)) ) {\n            //return false;\n            die(\"Preparation in table Registra Alumno failed: (\" . $mysql->errno . \") \" . $mysql->error);\n        }\n        \n        $user = $_SESSION[\"usuario\"];\n\t\tif (!$statement->bind_param(\"ssssssssssssssss\", \n\t\t$first_name, \n        $last_name, \n        $calle_numero,\n        $colonia,\n        $cp,\n        $municipio,\n        $ocupacion,\n        $estado_civil,\n        $fecha_nac_alumna,\n        $genero_alumna,\n        $telefono_casa_alumna,\n        $celular,\n        $estatus_fim,\n        $nombre_emergencia,\n        $emergencia_tel,\n        $enteraste\n        )) {\n            die(\"Parameter vinculation failed: (\" . $statement->errno . \") \" . $statement->error);\n            closeDB($mysql);\n            return false;\n        }\n\t\tif (!$statement->execute()) {\n            die(\"Execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            closeDB($mysql);\n            return false;\n        }else{\n        closeDB($mysql);\n        return true;\n        }\n\n    }\n\n    //Registrar Historial\n  \n    function registrarHistorialAcademico($id,\n        $grado_estudios,\n        $estatus_escolaridad,\n        $anio_suspension,\n        $motivo_susp,\n        $otros_estudios\n        ){\n        \n        $mysql = connectDB();\n        \n        $query = 'INSERT INTO HistorialAcademico (\n            ID_Alumno,\n            Grado_estudios,\n            Status,\n            anios_suspension,\n            motivo_suspension_estudios,\n            otros_estudios\n            ) VALUES (?,?,?,?,?,?)';\n        \n        if (!($statement = $mysql->prepare($query)) ) {\n            //return false;\n            die(\"Preparation in table historial academico failed: (\" . $mysql->errno . \") \" . $mysql->error);\n        }\n        \n        $user = $_SESSION[\"usuario\"];\n\t\tif (!$statement->bind_param(\"ississ\", \n\t\t       $id,\n    \t\t   $grado_estudios,\n               $estatus_escolaridad,\n               $anio_suspension,\n               $motivo_susp,\n               $otros_estudios\n\t\t   \n\t\t   )) {\n            die(\"Parameter vinculation failed: (\" . $statement->errno . \") \" . $statement->error);\n            closeDB($mysql);\n            return false;\n        }\n\t\tif (!$statement->execute()) {\n            die(\"Execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            closeDB($mysql);\n            return false;\n        }else{\n            closeDB($mysql);\n            return true;\n        }\n        }    \n        \n    \n        //REGISTRAR InfoLaboral\n        \n        function registrarInfoLaboral($id,\n        $empresa,\n        $puesto,\n        $antiguedad\n        ){\n        \n        $mysql = connectDB();        \n    \n        $query = 'INSERT INTO InfoLaboral (\n            ID_Alumno,\n            Empresa,\n            Puesto,\n            Antiguedad\n            ) VALUES (?,?,?,?)';\n         \n        if (!($statement = $mysql->prepare($query)) ) {\n            //return false;\n            die(\"Preparation in table InfoLaboral failed: (\" . $mysql->errno . \") \" . $mysql->error);\n        }\n        \n        $user = $_SESSION[\"usuario\"];\n\t\tif (!$statement->bind_param(\"issi\", $id, $empresa, $puesto , $antiguedad)) {\n            die(\"Parameter vinculation failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }\n\t\tif (!$statement->execute()) {\n            die(\"Execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }else{\n            closeDB($mysql);\n            return true;\n        }\n        }\n \n        //REGISTRAR herramientas tecnologicas\n        \n        function registrarHerramientas($id,\n        $acceso_it,\n        $herramientas\n        ){\n        \n        $mysql = connectDB();        \n    \n        $query = 'INSERT INTO AccesoIT (\n            ID_Alumno,\n            Acceso,\n            Herramientas\n            ) VALUES (?,?,?)';\n         \n        if (!($statement = $mysql->prepare($query)) ) {\n            //return false;\n            die(\"Preparation in table Herramientas failed: (\" . $mysql->errno . \") \" . $mysql->error);\n        }\n        \n        $user = $_SESSION[\"usuario\"];\n\t\tif (!$statement->bind_param(\"iss\", $id, $acceso_it, $herramientas)) {\n            die(\"Parameter vinculation failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }\n\t\tif (!$statement->execute()) {\n            die(\"Execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }else{\n            closeDB($mysql);\n            return true;\n        }\n        }\n        \n        \n        //REGISTRAR Situacion\n        \n        function registrarSituacion(\n        $id,\n        $vivienda_compartida,\n        $responsable_pago,\n        $parentesco,\n        $situacion_v,\n        $fuente_ingresos,\n        $ingresos,\n        $servicios\n        ){\n        \n        $mysql = connectDB(); \n        \n            $query = 'INSERT INTO Situacion (\n            ID_Alumno,\n            vivienda_compartida,\n            responsable_pago,\n            parentesco,\n            situacion_vivienda,\n            fuente_ingresos,\n            monto_ingresos,\n            servicios\n            ) VALUES (?,?,?,?,?,?,?,?)';\n         \n        if (!($statement = $mysql->prepare($query)) ) {\n            //return false;\n            die(\"Preparation in table Situacion failed: (\" . $mysql->errno . \") \" . $mysql->error);\n        }\n        \n        $user = $_SESSION[\"usuario\"];\n\t\tif (!$statement->bind_param(\"isssssss\",\n\t\t    $id,\n\t\t    $vivienda_compartida,\n            $responsable_pago,\n            $parentesco,\n            $situacion_v,\n            $fuente_ingresos,\n            $ingresos,\n            $servicios)) {\n            die(\"Parameter vinculation failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }\n\t\tif (!$statement->execute()) {\n            die(\"Execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }else{\n            closeDB($mysql);\n            return true;\n        }\n        }\n        \n\n        /*BUSCAR Alumna*/\n        \n        function consultarAlumnoNombre($first_name){\n             $conectar=connectDB();\n             $sql = \"SELECT Nombre, Apellidos, Estatus, ID_Alumno \n                        FROM Alumnos \n                        WHERE Nombre LIKE '%{$first_name}%'\";\n                         \n            $result = $conectar -> query($sql);\n            $tabla = '';\n                while($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {\n                    $tabla.='<tr>';\n                    $tabla.='<td onclick=\"mostrarInformacion('.$row[\"ID_Alumno\"].')\">' .$row[\"Nombre\"].'</td>';\n                    $tabla.='<td onclick=\"mostrarInformacion('.$row[\"ID_Alumno\"].')\">' .$row[\"Apellidos\"].'</td>';\n                    $tabla.='<td onclick=\"mostrarInformacion('.$row[\"ID_Alumno\"].')\">' .$row[\"Estatus\"].'</td>';\n                    $tabla.='<td> <a href=\"modificarAlumno.php?id='.$row[\"ID_Alumno\"].'\">' .'<i class=\"material-icons\">mode_edit</i>'.'</a>'.'</td>';\n                    $tabla.='<td onclick=\"confirmarEliminacionAlumna('. $row[\"ID_Alumno\"]. ')\"> <a href=\"#\"> <i class=\"material-icons\">delete</i> </a> </td>';\n                    $tabla.='</tr>';\n                }\n\n            closeDB($conectar);\n    \t\treturn $tabla;\n        }\n        \n        function listaAlumnasAJAX($filtro) {\n            $mysql= connectDB();\n            $query = \"SELECT Nombre, Apellidos, ID_Alumno FROM Alumnos ORDER BY Apellidos ASC\";\n            $result = $mysql -> query($query);\n            $lista = \"\";\n            while ($row = mysqli_fetch_array($result,MYSQLI_BOTH)) {\n                $nombre = $row[\"Apellidos\"]. \" \" . $row[\"Nombre\"];\n                if ($filtro === \"\") {\n                    $lista .= '<li class=\"collection-item\" onclick=\"seleccionarAlumna('.$row[\"ID_Alumno\"].',this)\">'.$nombre.'</li>';\n                } else {\n                    if (!((strpos(strtolower($nombre), strtolower($filtro))) === FALSE)) {\n                        $lista .= '<li class=\"collection-item\" onclick=\"seleccionarAlumna('.$row[\"ID_Alumno\"].',this)\">'.$nombre.'</li>';\n                    }\n                }\n            }\n            closeDB($mysql);\n            return $lista;\n        }\n        \n        function listaAlumnas(){\n             $conectar=connectDB();\n             $sql = \"SELECT Nombre, Apellidos, Estatus, ID_Alumno\n                        FROM Alumnos\";\n                         \n            $result = $conectar -> query($sql);\n            $tabla.='<td>' .$row[\"Nombre\"].'</td>';\n           //output data of each row\n            $tabla = \"<div class='content administrativo'> <fieldset><p>Alumnas </p>  <table class='bordered highlight  '>\";\n            $tabla.='<thead>\n                <tr>\n                <th data-field=\"nombre\"> Nombre</th>\n                <th data-field=\"apellido\"> Apellido</th>\n                <th data-field=\"status\">Status</th>\n                <th data-field=\"modificar\">Modificar</th>\n                <th data-field=\"eliminar\">Eliminar</th>             \n                </tr>\n            </thead>';\n            \n                while($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {\n                    $tabla.='<tr>';\n                    $tabla.='<td onclick=\"mostrarInformacion('. $row[\"ID_Alumno\"]. ')\">' .$row[\"Nombre\"].'</td>';\n                    $tabla.='<td onclick=\"mostrarInformacion('. $row[\"ID_Alumno\"]. ')\">' .$row[\"Apellidos\"].'</td>';\n                    $tabla.='<td onclick=\"mostrarInformacion('. $row[\"ID_Alumno\"]. ')\">' .$row[\"Estatus\"].'</td>';\n                    $tabla.='<td> <a href=\"modificarAlumno.php?id='.$row[\"ID_Alumno\"].'\">' .'<i class=\"material-icons\">mode_edit</i>'.'</a>'.'</td>';\n                    $tabla.='<td onclick=\"confirmarEliminacionAlumna('. $row[\"ID_Alumno\"]. ')\"> <a href=\"#\"> <i class=\"material-icons\">delete</i> </a> </td>';\n                    $tabla.='</tr>';\n                }\n                \n                 $tabla.= \"</table></fieldset><br></div>\";\n            closeDB($conectar);\n            echo $tabla;\n        }\n\n        \n        function consultarAlumnoApellido($last_name){\n            $conectar=connectDB();\n             $sql = \"SELECT Nombre, Apellidos, Estatus, ID_Alumno\n                        FROM Alumnos \n                        WHERE Apellidos LIKE '%{$last_name}%'\";\n                         \n            $result = $conectar -> query($sql);\n            $tabla = '';\n                while($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {\n                    $tabla.='<tr>';\n                    $tabla.='<td onclick=\"mostrarInformacion('.$row[\"ID_Alumno\"].')\">' .$row[\"Nombre\"].'</td>';\n                    $tabla.='<td onclick=\"mostrarInformacion('.$row[\"ID_Alumno\"].')\">' .$row[\"Apellidos\"].'</td>';\n                    $tabla.='<td onclick=\"mostrarInformacion('.$row[\"ID_Alumno\"].')\">' .$row[\"Estatus\"].'</td>';\n                    $tabla.='<td> <a href=\"modificarAlumno.php?id='.$row[\"ID_Alumno\"].'\">' .'<i class=\"material-icons\">mode_edit</i>'.'</a>'.'</td>';\n                    $tabla.='<td onclick=\"confirmarEliminacionAlumna('.$row[\"ID_Alumno\"].')\"> <a href=\"#\"> <i class=\"material-icons\">delete</i> </a> </td>';\n                    $tabla.='</tr>';\n                }\n            closeDB($conectar);\n    \t\treturn $tabla;\n        }\n        \n        function consultarAlumnoFecha($fechaInscripcion){\n\n        }\n        \n        function consultarAlumnoStatus($status){\n            \n        }\n        \n        function consultarPerfilCompleto(){\n            \n        }\n        \n        /*VISUALIZAR la informaciÃ³n de alumnas*/\n                \n        function tablaInfoAlumnas($id){\n             $conectar = connectDB();\n                $query =\"SELECT *\n                        FROM Alumnos\n                        WHERE ID_Alumno = '$id'\";       \n                \n                $results = $conectar->query($query);\n                $row = mysqli_fetch_array($results, MYSQLI_ASSOC);\n                //var_dump($row[\"Nombre\"]);\n                $tabla = '';\n               \n                    $tabla.='<tr>';\n                    $tabla.='<td>' .$row[\"Nombre\"].'</td>';\n                    $tabla.='<td>' .$row[\"Apellidos\"].'</td>';\n                    $tabla.='<td>' .$row[\"Calle_numero\"].'</td>';\n                    $tabla.='<td>' .$row[\"Colonia\"].'</td>';\n                    $tabla.='<td>' .$row[\"ZIP\"].'</td>';\n                    $tabla.='<td>' .$row[\"Municipio\"].'</td>';\n                    $tabla.='<td>' .$row[\"Ocupacion\"].'</td>';\n                    $tabla.='<td>' .$row[\"Estado_Civil\"].'</td>';\n                    $tabla.='<td>' .$row[\"Fecha_de_nacimiento\"].'</td>';\n                    $tabla.='<td>' .$row[\"Genero\"].'</td>';\n                    $tabla.='<td>' .$row[\"Tcasa\"].'</td>';\n                    $tabla.='<td>' .$row[\"Tcel\"].'</td>';\n                    $tabla.='<td>' .$row[\"Estatus\"].'</td>';\n                    $tabla.='<td>' .$row[\"Contacto_Nombre\"].'</td>';\n                    $tabla.='<td>' .$row[\"Contacto_telefono\"].'</td>';\n                    $tabla.='<td>' .$row[\"medio_se_entero_FIM\"].'</td>';\n                    $tabla.='</tr>';\n            closeDB($conectar);\n            return $tabla;\n        }\n        \n        function tablaInfoAcademica($id){\n            $conectar = connectDB();\n                $query =\"SELECT *\n                        FROM HistorialAcademico\n                        WHERE ID_Alumno = '$id'\";       \n                $results = $conectar->query($query);\n                $row = mysqli_fetch_array($results, MYSQLI_ASSOC);\n                $tabla = '';\n                    $tabla.='<tr>';\n                    $tabla.='<td>' .$row[\"Grado_estudios\"].'</td>';\n                    $tabla.='<td>' .$row[\"Status\"].'</td>';\n                    $tabla.='<td>' .$row[\"anios_suspension\"].'</td>';\n                    $tabla.='<td>' .$row[\"motivo_suspension_estudios\"].'</td>';\n                    $tabla.='<td>' .$row[\"otros_estudios\"].'</td>';\n                    $tabla.='</tr>';\n            closeDB($conectar);\n            return $tabla;\n        }\n        \n        function tablaInfoLaboral($id){\n            $conectar = connectDB();\n                $query =\"SELECT *\n                        FROM InfoLaboral\n                        WHERE ID_Alumno = '$id'\";       \n                $results = $conectar->query($query);\n                $row = mysqli_fetch_array($results, MYSQLI_ASSOC);\n                $tabla = '';\n                    $tabla.='<tr>';\n                    $tabla.='<td>' .$row[\"Empresa\"].'</td>';\n                    $tabla.='<td>' .$row[\"Puesto\"].'</td>';\n                    $tabla.='<td>' .$row[\"Antiguedad\"].'</td>';\n                    $tabla.='</tr>';\n            closeDB($conectar);\n            return $tabla;\n        }\n        \n        function tablaInfoHerramientas($id){\n            $conectar = connectDB();\n                $query =\"SELECT *\n                        FROM AccesoIT\n                        WHERE ID_Alumno = '$id'\";       \n                $results = $conectar->query($query);\n                $row = mysqli_fetch_array($results, MYSQLI_ASSOC);\n                $tabla = '';\n                    $tabla.='<tr>';\n                    $tabla.='<td>' .$row[\"Acceso\"].'</td>';\n                    $tabla.='<td>' .$row[\"Herramientas\"].'</td>';\n                    $tabla.='</tr>';\n            closeDB($conectar);\n            return $tabla;\n        }\n        \n        function tablaInfoSituacion($id){\n            $conectar = connectDB();\n                $query =\"SELECT *\n                        FROM Situacion\n                        WHERE ID_Alumno = '$id'\";       \n                $results = $conectar->query($query);\n                $row = mysqli_fetch_array($results, MYSQLI_ASSOC);\n                $tabla = '';\n                    $tabla.='<tr>';\n                    $tabla.='<td>' .$row[\"vivienda_compartida\"].'</td>';\n                    $tabla.='<td>' .$row[\"responsable_pago\"].'</td>';\n                    $tabla.='<td>' .$row[\"parentesco\"].'</td>';\n                    $tabla.='<td>' .$row[\"situacion_vivienda\"].'</td>';\n                    $tabla.='<td>' .$row[\"fuente_ingresos\"].'</td>';\n                    $tabla.='<td>' .$row[\"monto_ingresos\"].'</td>';\n                    $tabla.='<td>' .$row[\"servicios\"].'</td>';\n                    $tabla.='</tr>';\n            closeDB($conectar);\n            return $tabla;\n        }\n        \n        \n        function tablaInfoTotal(){\n            $conectar = connectDB();\n            $query =\"SELECT *\n                    FROM Alumnos\n                    ORDER BY Nombre ASC\";       \n            $results = $conectar->query($query);\n            //$row = mysqli_fetch_array($results, MYSQLI_ASSOC);\n \n            /*headers de tabla*/    \n            $tabla=\"\";\n            $tabla.=\"<table class='bordered striped centered' cellspacing='0' cellpadding='0'>\";\n            $tabla.='<thead>\n                    <tr>\n                    <th class=\"minWidth\"> Nombre </th>\n                    <th class=\"minWidth\">Apellido</th>\n                    <th class=\"minWidth\">Calle y nÃºmero </th>\n                    <th class=\"minWidth\">Colonia</th>\n                    <th class=\"minWidth\">CÃ³digo Postal</th>\n                    <th class=\"minWidth\">Municipio</th>\n                    <th class=\"minWidth\">OcupaciÃ³n</th>\n                    <th class=\"minWidth\">Estado Civil</th>\n                    <th class=\"minWidth\">Nacimiento</th>\n                    <th class=\"minWidth\">GÃ©nero</th>\n                    <th class=\"minWidth\">Tel.Casa</th>\n                    <th class=\"minWidth\">Celular</th>\n                    <th class=\"minWidth\">Estatus</th>\n                    <th class=\"minWidth\">Contacto Emergencia</th>\n                    <th class=\"minWidth\">Tel. Emergencia</th>\n                    <th class=\"minWidth\">Como se enterÃ³ de FIM</th>\n                    </tr>\n                    </thead>\n                    <tbody>';\n            /*finaliza headers de tabla*/\n                \n            /*contenido de tabla*/\n            while($row = mysqli_fetch_array($results, MYSQLI_BOTH)) {\n                $tabla.='<tr>';\n                $tabla.='<td>' .$row[\"Nombre\"].'</td>';\n                $tabla.='<td>' .$row[\"Apellidos\"].'</td>';\n                $tabla.='<td>' .$row[\"Calle_numero\"].'</td>';\n                $tabla.='<td>' .$row[\"Colonia\"].'</td>';\n                $tabla.='<td>' .$row[\"ZIP\"].'</td>';\n                $tabla.='<td>' .$row[\"Municipio\"].'</td>';\n                $tabla.='<td>' .$row[\"Ocupacion\"].'</td>';\n                $tabla.='<td>' .$row[\"Estado_Civil\"].'</td>';\n                $tabla.='<td>' .$row[\"Fecha_de_nacimiento\"].'</td>';\n                $tabla.='<td>' .$row[\"Genero\"].'</td>';\n                $tabla.='<td>' .$row[\"Tcasa\"].'</td>';\n                $tabla.='<td>' .$row[\"Tcel\"].'</td>';\n                $tabla.='<td>' .$row[\"Estatus\"].'</td>';\n                $tabla.='<td>' .$row[\"Contacto_Nombre\"].'</td>';\n                $tabla.='<td>' .$row[\"Contacto_telefono\"].'</td>';\n                $tabla.='<td>' .$row[\"medio_se_entero_FIM\"].'</td>';\n                $tabla.='</tr>';\n            }\n            /*finaliza contenido de tabla*/\n                \n            $tabla.= \"</tbody></table>\";\n            //echo $tabla;\n            closeDB($conectar);\n            return $tabla;\n        }\n        \n        function tablaInfoPDF(){\n            $conectar = connectDB();\n            $query =\"SELECT *\n                    FROM Alumnos\n                    ORDER BY Nombre ASC\";       \n            $results = $conectar->query($query);\n            //$row = mysqli_fetch_array($results, MYSQLI_ASSOC);\n \n            /*headers de tabla*/    \n            $tabla=\"\";\n            $tabla.=\"<table cellspacing='0' cellpadding='0'>\";\n            $tabla.='<thead>\n                    <tr>\n                    <th class=\"minWidth\"><strong> Nombre </strong></th>\n                    <th class=\"minWidth\"><strong>Apellido </strong></th>\n                    <th class=\"minWidth\"><strong>Calle y nÃºmero </strong></th>\n                    <th class=\"minWidth\"><strong>Colonia </strong></th>\n                    <th class=\"minWidth\"><strong>CÃ³digo Postal </strong></th>\n                    <th class=\"minWidth\"><strong>Municipio </strong></th>\n                    <th class=\"minWidth\"><strong>Nacimiento </strong></th>\n                    <th class=\"minWidth\"><strong>Celular </strong></th>\n                    <th class=\"minWidth\"><strong>Estatus </strong></th>\n                    </tr>\n                    </thead>\n                    <tbody>';\n            /*finaliza headers de tabla*/\n                \n            /*contenido de tabla*/\n            while($row = mysqli_fetch_array($results, MYSQLI_BOTH)) {\n                $tabla.='<tr>';\n                $tabla.='<td>' .$row[\"Nombre\"].'</td>';\n                $tabla.='<td>' .$row[\"Apellidos\"].'</td>';\n                $tabla.='<td>' .$row[\"Calle_numero\"].'</td>';\n                $tabla.='<td>' .$row[\"Colonia\"].'</td>';\n                $tabla.='<td>' .$row[\"ZIP\"].'</td>';\n                $tabla.='<td>' .$row[\"Municipio\"].'</td>';\n                $tabla.='<td>' .$row[\"Fecha_de_nacimiento\"].'</td>';\n                $tabla.='<td>' .$row[\"Tcel\"].'</td>';\n                $tabla.='<td>' .$row[\"Estatus\"].'</td>';\n                $tabla.='</tr>';\n            }\n            /*finaliza contenido de tabla*/\n                \n            $tabla.= \"</tbody></table>\";\n            closeDB($conectar);\n            return $tabla;\n        }\n\n        \n        /* FIN DE VISUALIZAR INFORMACION DE ALUMNAS */\n        \n        /*MODIFICAR Alumno*/\n        \n        //Get ID de alumno\n        function getID($first_name, $last_name, $fecha_nac_alumna){\n            \n                $conectar = connectDB();\n                $query =\"SELECT ID_Alumno\n                        FROM Alumnos\n                        WHERE Nombre = '$first_name'\n                        AND Apellidos = '$last_name'\n                        AND Fecha_de_nacimiento = '$fecha_nac_alumna'\";       \n                \n                $results = $conectar->query($query);\n                //var_dump($query);\n                $row = mysqli_fetch_array($results, MYSQLI_ASSOC);\n                $miID = $row[\"ID_Alumno\"];\n        \n                return $miID;\n        }\n        \n        /*duplicado x id*/\n        \n        function noID($id, $tabla){\n            \n                $conectar = connectDB();\n                $query =\"SELECT COUNT(*) AS filas\n                        FROM $tabla\n                        WHERE ID_Alumno = $id\";       \n                \n                $results = $conectar->query($query);\n                //var_dump($query);\n                $row = mysqli_fetch_array($results, MYSQLI_ASSOC);\n                $numero = $row[\"filas\"];\n        \n                if ($numero == 0) {\n                    echo \"<script type='text/javascript'>console.log( 'REGISTRAR');</script>\";\n                    mysqli_free_result($results);\n                    closeDB($conectar);\n                    return true;\n                }else{\n                    echo \"<script type='text/javascript'>console.log('ACTUALIZAR');</script>\";\n                    mysqli_free_result($results);\n                    closeDB($conectar);\n                    return false;\n                }\n                \n        }\n        \n        \n        function modificarInfoPersonal($id, \n        $first_name, \n        $last_name, \n        $calle_numero,\n        $colonia,\n        $municipio,\n        $cp,\n        $ocupacion,\n        $estado_civil,\n        $fecha_nac_alumna,\n        $telefono_casa_alumna,\n        $celular,\n        $genero_alumna,\n        $estatus_fim,\n        $enteraste,\n        $nombre_emergencia,\n        $emergencia_tel\n        ){\n            \n        $mysql = connectDB();\n\n        $query = 'UPDATE Alumnos\n            SET Nombre ='.\"'\".$first_name.\"'\".', \n            Apellidos ='.\"'\".$last_name.\"'\".', \n            Calle_numero ='.\"'\".$calle_numero.\"'\".', \n            Colonia ='.\"'\".$colonia.\"'\".', \n            ZIP ='.\"'\".$cp.\"'\".', \n            Municipio ='.\"'\".$municipio.\"'\".', \n            Ocupacion ='.\"'\".$ocupacion.\"'\".', \n            Estado_Civil ='.\"'\".$estado_civil.\"'\".', \n            Fecha_de_nacimiento ='.\"'\".$fecha_nac_alumna.\"'\".', \n            Genero ='.\"'\".$genero_alumna.\"'\".', \n            Tcasa ='.\"'\".$telefono_casa_alumna.\"'\".', \n            Tcel ='.\"'\".$celular.\"'\".', \n            Estatus ='.\"'\".$estatus_fim.\"'\".', \n            Contacto_Nombre ='.\"'\".$nombre_emergencia.\"'\".', \n            Contacto_telefono ='.\"'\".$emergencia_tel.\"'\".', \n            medio_se_entero_FIM ='.\"'\".$enteraste.\"'\".'\n            WHERE ID_Alumno ='.$id;\n        //var_dump($query);\n            \n        if (!($statement = $mysql->prepare($query)) ) {\n            //return false;\n            die(\"Preparation in table Update Alumno failed: (\" . $mysql->errno . \") \" . $mysql->error);\n        }\n        \n\t\tif (!$statement->execute()) {\n            die(\"Update execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            closeDB($mysql);\n            return false;\n        }else{\n        closeDB($mysql);\n        return true;\n        }\n            \n        }\n        \n        \n        function modificarHistorialAcademico($id,\n                $grado_estudios,\n                $estatus_escolaridad,\n                $anio_suspension,\n                $motivo_susp,\n                $otros_estudios\n        ){\n            \n            $mysql = connectDB();\n         \n            $query = 'UPDATE HistorialAcademico\n                SET Grado_estudios ='.\"'\".$grado_estudios.\"'\".', \n                Status ='.\"'\".$estatus_escolaridad.\"'\".', \n                anios_suspension ='.\"'\".$anio_suspension.\"'\".',\n                motivo_suspension_estudios ='.\"'\".$motivo_susp.\"'\".',\n                otros_estudios ='.\"'\".$otros_estudios.\"'\".'\n                WHERE ID_Alumno ='.$id;\n            //var_dump($query);\n                \n            if (!($statement = $mysql->prepare($query)) ) {\n                //return false;\n                die(\"Preparation in table Update Alumno failed: (\" . $mysql->errno . \") \" . $mysql->error);\n            }\n            \n    \t\tif (!$statement->execute()) {\n                die(\"Update execution failed: (\" . $statement->errno . \") \" . $statement->error);\n                closeDB($mysql);\n                return false;\n            }else{\n            closeDB($mysql);\n            return true;\n            }\n            \n        }\n        \n        function modificarInfoLaboral($id,\n                $empresa,\n                $puesto,\n                $antiguedad\n        ){\n            \n            $mysql = connectDB();\n         \n            $query = 'UPDATE InfoLaboral\n                SET Empresa ='.\"'\".$empresa.\"'\".', \n                Puesto ='.\"'\".$puesto.\"'\".', \n                Antiguedad ='.\"'\".$antiguedad.\"'\".'\n                WHERE ID_Alumno ='.$id;\n            //var_dump($query);\n                \n            if (!($statement = $mysql->prepare($query)) ) {\n                //return false;\n                die(\"Preparation in table Update Alumno failed: (\" . $mysql->errno . \") \" . $mysql->error);\n            }\n            \n    \t\tif (!$statement->execute()) {\n                die(\"Update execution failed: (\" . $statement->errno . \") \" . $statement->error);\n                closeDB($mysql);\n                return false;\n            }else{\n            closeDB($mysql);\n            return true;\n            }\n            \n        }\n        \n        \n        function modificarHerramientas($id,\n                $acceso_it,\n                $herramientas\n        ){\n            \n            $mysql = connectDB();\n         \n            $query = 'UPDATE AccesoIT\n                SET Acceso ='.\"'\".$acceso_it.\"'\".', \n                Herramientas ='.\"'\".$herramientas.\"'\".'\n                WHERE ID_Alumno ='.$id;\n            //var_dump($query);\n                \n            if (!($statement = $mysql->prepare($query)) ) {\n                //return false;\n                die(\"Preparation in table Update Alumno failed: (\" . $mysql->errno . \") \" . $mysql->error);\n            }\n            \n    \t\tif (!$statement->execute()) {\n                die(\"Update execution failed: (\" . $statement->errno . \") \" . $statement->error);\n                closeDB($mysql);\n                return false;\n            }else{\n            closeDB($mysql);\n            return true;\n            }\n            \n        }\n        \n        function modificarSituacion($id,\n            $vivienda_compartida,\n            $responsable_pago,\n            $parentesco,\n            $situacion_v,\n            $fuente_ingresos,\n            $ingresos,\n            $servicios\n        ){\n            \n            $mysql = connectDB();\n         \n            $query = 'UPDATE Situacion\n                SET vivienda_compartida ='.\"'\".$vivienda_compartida.\"'\".', \n                responsable_pago ='.\"'\".$responsable_pago.\"'\".',\n                parentesco ='.\"'\".$parentesco.\"'\".',\n                situacion_vivienda ='.\"'\".$situacion_v.\"'\".',\n                fuente_ingresos ='.\"'\".$fuente_ingresos.\"'\".',\n                monto_ingresos ='.\"'\".$ingresos.\"'\".',\n                servicios ='.\"'\".$servicios.\"'\".'\n                WHERE ID_Alumno ='.$id;\n            //var_dump($query);\n       \n            if (!($statement = $mysql->prepare($query)) ) {\n                //return false;\n                die(\"Preparation in table Update Alumno failed: (\" . $mysql->errno . \") \" . $mysql->error);\n            }\n            \n    \t\tif (!$statement->execute()) {\n                die(\"Update execution failed: (\" . $statement->errno . \") \" . $statement->error);\n                closeDB($mysql);\n                return false;\n            }else{\n            closeDB($mysql);\n            return true;\n            }\n            \n        }\n        \n        \n        function recuperarInformacionPersonal($id){\n            $conectar = connectDB();\n            $query = \"SELECT * FROM Alumnos WHERE ID_Alumno=$id\";\n            $result = $conectar -> query($query);\n            //var_dump($result);\n            if(!$result){\n                return \"\";\n            }\n            $row = mysqli_fetch_array($result, MYSQLI_BOTH);\n            closeDB($conectar);\n            return $row;\n        }\n        \n        \n        \n        function recuperarHistorialAcademico($id){\n            $conectar = connectDB();\n            $query = 'SELECT * FROM HistorialAcademico WHERE ID_Alumno='.$id;\n            $result = $conectar -> query($query);\n            //var_dump($result);\n            if(!$result){\n                return \"\";\n            }\n            $row = mysqli_fetch_array($result, MYSQLI_BOTH);\n            closeDB($conectar);\n            return $row;\n        }\n        \n        function recuperarInfoLaboral($id){\n            $conectar = connectDB();\n            $query = 'SELECT * FROM InfoLaboral WHERE ID_Alumno='.$id;\n            $result = $conectar -> query($query);\n            //var_dump($result);\n            if(!$result){\n                return \"\";\n            }\n            $row = mysqli_fetch_array($result, MYSQLI_BOTH);\n            closeDB($conectar);\n            return $row;\n        }\n        \n        function recuperarHerramientas($id){\n            $conectar = connectDB();\n            $query = 'SELECT * FROM AccesoIT WHERE ID_Alumno='.$id;\n            $result = $conectar -> query($query);\n            //var_dump($result);\n            if(!$result){\n                return \"\";\n            }\n            $row = mysqli_fetch_array($result, MYSQLI_BOTH);\n            closeDB($conectar);\n            return $row;\n        }\n        \n        function recuperarSituacion($id){\n            $conectar = connectDB();\n            $query = 'SELECT * FROM Situacion WHERE ID_Alumno='.$id;\n            $result = $conectar -> query($query);\n            //var_dump($result);\n            if(!$result){\n                return \"\";\n            }\n            $row = mysqli_fetch_array($result, MYSQLI_BOTH);\n            closeDB($conectar);\n            return $row;\n        }\n        /*\n        */\n        /*ELIMINAR Alumno*/\n        \n        function eliminarAlumno($id) {\n        $conectar = connectDB();\n        echo \"ID:\";\n        var_dump($id);\n        $query = 'DELETE From Alumnos WHERE ID_Alumno='.$id;\n        //incluir delete de las otras tablas\n        echo \"<script type='text/javascript'>console.log( 'vamos por la query');</script>\";\n         echo \"query:\";\n        //var_dump($query);\n        $consulta=mysqli_query($conectar, $query);\n        closeDB($conectar);\n        return $consulta;\n    }\n    \n\n/*\n _________________________________________ INFORMACION INSTITUCIONAL _________________________________________ \n*/\n\n    function listaInformacion() {\n        $mysql = connectDB();\n        $query = \"SELECT * FROM infoFIM ORDER BY ID_info DESC\";\n        $result = $mysql -> query($query);\n        $tabla = '';\n            while($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {\n                $tabla.='<tr>';\n                    $tabla.= '<td><strong>' .$row[\"nombre\"].'</strong></td>';\n                    $tabla.= '<td><p>   </p></td>';\n                    $tabla.= '<td>' . $row[\"descripcion\"] . '</td>';\n                    $tabla.= '<td> <a href=\"modificarInformacion.php?id='.$row[\"ID_info\"].'\"><i class=\"material-icons\">mode_edit</i></a> </td>';\n                $tabla.='</tr>';\n            }\n        closeDB($mysql);\n\t\treturn $tabla;\n    }\n    \n    function recuperarInformacion($id) {\n        $mysql = connectDB();\n        $query = 'SELECT * FROM infoFIM WHERE ID_info='.$id;\n        $result = $mysql -> query($query);\n        $row = mysqli_fetch_array($result, MYSQLI_BOTH);\n        closeDB($mysql);\n        return $row;\n    }\n    \n    function modificarInformacion($id, $descripcion){ \n        $mysql = connectDB();\n         \n            $query = 'UPDATE infoFIM\n                SET descripcion ='.\"'\".$descripcion.\"'\".'\n                WHERE ID_Info ='.$id;\n            //var_dump($query);\n       \n            if (!($statement = $mysql->prepare($query)) ) {\n                //return false;\n                die(\"Preparation in table Update infoFIM failed: (\" . $mysql->errno . \") \" . $mysql->error);\n            }\n            \n    \t\tif (!$statement->execute()) {\n                die(\"Update execution failed: (\" . $statement->errno . \") \" . $statement->error);\n                closeDB($mysql);\n                return false;\n            }else{\n            closeDB($mysql);\n            return true;\n            }\n    }\n\n\n\n/*\n _________________________________________ VALIDACION _________________________________________ \n*/\n    \n    function isValidPhone($cadena){\n\t\treturn (preg_match(\"/^\\d{7,10}$/\",trim($cadena)));\n    }\n    \n    function isValidMail($cadena){\n        return (preg_match(\"/^[_a-z0-9-]+(\\.[_a-z0-9-]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,3})$/\",trim($cadena)));\n    }\n    \n    function isValidRFC($cadena){\n        return (preg_match(\"/^[A-Z]{3,4}\\d{6}[A-Z\\d]{2}[\\dA]$/\",strtoupper(trim($cadena))));\n    }\n    \n\n   /*-----------SESIONES----------*/\n   \n   function checkSession() {\n       if (!session_id()) {\n            return false;\n       } else {\n           $time = time();\n           //4 horas\n           if ($time - $_SESSION[\"ultimaactividad\"] <= 14400) {\n               $_SESSION[\"ultimaactividad\"] = $time;\n               return true;\n           } else {\n               session_unset();\n               session_destroy();\n               return false;\n           }\n       }\n   }\n   \n   function login($user, $password) {\n       $mysql = connectDB();\n       $query = \"SELECT * FROM Usuarios WHERE nombre_usuario='\".$user.\"'\";\n       $result = $mysql -> query($query);\n       if (($result->num_rows) > 0) {\n           $row = mysqli_fetch_array($result, MYSQLI_BOTH);\n           if ($row[\"contrasena\"] === $password) {\n               session_start();\n               $_SESSION[\"usuario\"] = $user;\n               $_SESSION[\"nombre\"] = $row[\"nombre\"];\n               $_SESSION[\"ultimaactividad\"] = time();\n               $_SESSION[\"tipoUsuario\"] = $row[\"ID_ROL\"];\n               closeDB($mysql);\n               return true;\n           }\n       }\n       closeDB($mysql);\n       return false;\n   }\n   \n   /*REPORTE*/\n   \n   function reportePDF(){\n       $mysql = connectDB();\n   }\n   \n   \n   /*----------GALERÃA--------*/\n   function imagenesGaleria() {\n       $mysql = connectDB();\n       $query = 'SELECT * FROM FotosGaleria ORDER BY fecha DESC';\n       $result = $mysql -> query($query);\n       $imagenes = '<div class=\"square\"><div class=\"addIcon\"><div class=\"table\"> <div class=\"table-cell\" onclick=\"agregarImagenAGaleria()\"><img class=\"rs\" src=\"Images/addImage.png\"></div></div></div></div>';\n       while ($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {\n           $imagenes.= '<div class=\"square\"> <div class=\"imgContent\"> <div class=\"table\"> <div class=\"table-cell\">  <a href=\"#\" onclick=\"confirmarEliminacionImagen('.$row[\"ID_FotoGaleria\"].')\"> <i class=\"material-icons right deleteicon\" hidden>delete</i></a>\n <img class=\"rs\" src=\"'.$row[\"ubicacion\"].'\"/> </div> </div> </div> </div>';   \n       }\n       closeDB($mysql);\n       return $imagenes;\n   }\n   \n   function anadirImagenGaleria($ubicacion, $fecha, $titulo) {\n       $mysql = connectDB();\n       $query = 'INSERT INTO FotosGaleria (ubicacion,fecha,titulo) VALUES (?,?,?)';\n       if (!($statement = $mysql->prepare($query))) {\n            //return false;\n            die(\"Preparation failed: (\" . $mysql->errno . \") \" . $mysql->error);\n        }\n\t\tif (!$statement->bind_param(\"sss\",$ubicacion, $fecha , $titulo)) {\n            die(\"Parameter vinculation failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        }\n\t\tif (!$statement->execute()) {\n            die(\"Execution failed: (\" . $statement->errno . \") \" . $statement->error);\n            return false;\n        } \n         else {\n            closeDB($mysql);\n            return true;\n        }\n   }\n   \n   function eliminarImagenGaleria($id){\n       $mysql = connectDB();                            \n       //Eliminar archivo del Servidor\n       $query1 = 'SELECT * FROM FotosGaleria WHERE ID_FotoGaleria='.$id;\n       $result = $mysql->query($query1);\n       $row = mysqli_fetch_array($result, MYSQLI_BOTH);\n       $archivo = __DIR__.'/'.$row[\"ubicacion\"];\n       unlink($archivo);\n       //Eliminar Registro de la Base de Datos\n       $query2 = 'DELETE FROM FotosGaleria WHERE ID_FotoGaleria='.$id;\n       $mysql -> query($query2);\n       closeDB($mysql);\n   }\n   \n   function listaDeImagenesGaleria() {\n       $mysql = connectDB();\n       $query = 'SELECT * FROM FotosGaleria';\n       $result = $mysql -> query($query);\n       $lista = \"\";\n       while ($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {\n           $lista.='<li>';\n           $lista.='<img height=\"600px\" src=\"'.$row[\"ubicacion\"].'\"/>';\n           $lista.='<div class=\"caption center-align\">\n                      <div class=\"container\">\n                        <div class=\"row center\">\n                          <h3 class=\"col s1Â¡2 light pinkFim-opa\">!Ãšnete a FIM!</h3>\n                        </div>\n                        <div class=\"row center\">\n                          <h5 class=\"header col  s1Â¡2 light flow-text pinkFim-opa\">'.$row[\"titulo\"].'</h5>\n                        </div>\n                      </div>\n                    </div>';\n            $lista.='</li>';\n       }\n       return $lista;\n   }\n   \n   /*-- ROLES --*/\n   \n   //Obtiene las funciones con con base al rol del usuario y regresa una lista con cada una de ellas\n   function obtenerFunciones(){\n       //Arreglo asociativo con el nombre del archivo para cada funciÃ³n.\n       $nombresArchivos = [\n           \"Alumnos\" => \"con_alumna.php\",\n           \"Inscribir Taller\" => \"inscribirTaller.php\",\n           \"Talleres\" => \"taller.php\",\n           \"Noticia\" => \"modificareliminar_Noticia.php\",\n           \"Galer&iacute;a de Im&aacute;genes\" => \"imagenesGaleria.php\",\n           \"Gastos\" => \"gastos.php\",\n           \"Usuarios\" => \"consultaUsuario.php\",\n           \"Donaciones\" => \"https://www.paypal.com/mx/webapps/mpp/home\",\n           \"Informaci&oacute;n Institucional\" => \"consultaInformacion.php\",\n        ];\n        //Hacer consulta a base de datos para obtener las funciones del usuario\n       $rol = $_SESSION[\"tipoUsuario\"];\n       $mysql = connectDB();\n       $query = 'SELECT * FROM Privilegios p, Gozan g WHERE g.ID_Rol='.$rol.' AND g.ID_Privilegios=p.ID_Privilegios';\n       $result = $mysql -> query($query);\n       \n       //Armar lista con base al resultado de la consulta\n       $lista = \"\";\n       while ($row = mysqli_fetch_array($result,MYSQLI_BOTH)) {\n            $lista.='<li><a class=\"waves-effect\" href=\"'.$nombresArchivos[$row[\"descripcion\"]].'\">'.$row[\"descripcion\"].'</a></li>';\n       }\n       \n       return $lista;\n   }\n   \n   //Verificar que la sesiÃ³n actual sea de un usuario tipo administrador\n   function funcionAdministrador() {\n       if ($_SESSION[\"tipoUsuario\"] == 3) {\n           return true;\n       } else {\n           return false;\n       }\n   }\n   \n?>","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":35597.02284655758,"scrollleft":0,"selection":{"start":{"row":1865,"column":9},"end":{"row":1865,"column":9},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":1778,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1495183451000}